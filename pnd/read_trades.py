import ast
import datetime as dt
import pandas as pd
import utils

filepath = 'data/trades/LTCBTC.csv'

if __name__ == '__main__':
    pd.set_option('display.max_rows', None)
    pd.set_option('display.max_columns', None)
    pd.set_option('display.width', None)

    data = []
    with open(filepath, 'r') as f:
        for line in f:
            data.append(ast.literal_eval(line.strip()))
    df = pd.DataFrame(data)
    df.columns = utils.BINANCE_TRADES_COLS
    df = df.drop(columns=['Ignore'])
    df['Event time'] = pd.to_datetime(df['Event time'] * 1000000)
    df['Trade time'] = pd.to_datetime(df['Trade time'] * 1000000)

    print(df)
